{
  "version": 3,
  "sources": ["../src/PokeApi-Explorer.js"],
  "sourcesContent": ["import FetchElement from 'https://unpkg.com/slotted-element@1.1.0/fetch-element.js';\n// import { CssChain as $$ } from \"https://unpkg.com/css-chain@1/CssChain.js\";\nimport { CssChain as $$ } from \"./CssChain.js\";\n\nconst arr2str = (arr,cb, separator='') => arr.map(cb).join(separator)\n,   isImg = url => url && url.endsWith && ['png','gif','svg'].find( x=>url.endsWith(x) );\n\nwindow.customElements.define('pokemon-link-element',\n    class PokemonInfoElement extends HTMLElement\n    {\n        connectedCallback()\n        {\n            const $this = $$(this)\n            ,   $ = x => $this.$(x)\n            ,     name = $this.attr('name')\n            ,      url = $this.attr('url');\n            if( isImg(url) )\n            {\n                debugger;\n                return $this.html( `<img title=\"${ name }\" src=\"${ url }\">` );\n            }\n\n\n            $this.html(`<a href=\"${url}\">${name}</a><dl></dl>`);\n\n            $('a').on('click', async e=>\n            {   e.preventDefault();\n                if(this.loaded)\n                    return $('dl').erase(), this.loaded=0;\n                this.loaded =1;\n                const d = await ( await fetch(url) ).json();\n                $('dl').html( render(d) );\n            });\n\n            function render( d, n='' )\n            {\n                if( d === undefined || d === null || 'string' === typeof d || 'number' === typeof d )\n                {   if( isImg(d) )\n                        return `<img title=\"${n}\\n${d}\" src=\"${d}\">`;\n                    return n ? `<span><code>${ n }</code> : <val>${ d }</val></span>` : `<val>${ d }</val>`;\n                }\n                if( Array.isArray( d ))\n                    return `<fieldset><legend>${n}</legend>${  arr2str( d, render,'<hr/>' ) }</fieldset>`;\n\n                let ret = [], keys = Object.keys(d);\n                const link = ( d.name && d.url ) && isImg(d.url)\n                       ? `<img title=\"${name}\" src=\"${url}\"/>`\n                       : `<pokemon-link-element name=\"${d.name}\" url=\"${d.url}\"></pokemon-link-element> `;\n\n                if( keys.length ===2 && d.name && d.url )\n                    ret.push( link )\n                else\n                {   if( n )\n                    {   ret.push( '<fieldset>' );\n                        ret.push( `<legend>${ n }</legend>` )\n                    }\n                    for( let k in d )\n                        switch( k )\n                        {   case 'name':\n                                if( d.url )\n                                    break;\n                            case 'url':\n                                d.url && d.name && ret.push( link ); break;\n                            default:\n                                if( Array.isArray( d[ k ] ) )\n                                    ret.push( `<fieldset><legend>${ k }</legend>${\n                                        arr2str( d[ k ], v=>render(v),'<hr/>' )\n                                    }</fieldset>` );\n                                else\n                                    ret.push( render( d[ k ], k ) );\n                        }\n                    n && ret.push( '</fieldset>' );\n                }\n                return ret.join('')\n            }\n        }\n\n    });\n\n\nwindow.customElements.define('pokemon-info-element',\n    class PokemonInfoElement extends FetchElement\n    {\n        render(pokemon)\n        {\n            const { other, versions, ...sprites } = pokemon.sprites;\n            const renderCollection = (title, obj) =>  `<fieldset><legend>${title}</legend>\n                ${  arr2str( Object.entries(obj), ([k,v]) => !v ? ''\n                           : ('string' === typeof v\n                              ? `<img src=\"${v}\" title=\"${k}\"/>`\n                              : renderCollection(k,v) ) )\n                }</fieldset>`;\n            const renderAbilities = () =>  `<fieldset><legend>abilities</legend>\n                ${  arr2str( pokemon.abilities, a => `<a href=\"${a.ability.url}\">${a.ability.name}</a><sup>${a.slot}</sup>` )\n                }</fieldset>`;\n            const nameUrlArr = (name,arr)=>`<details><summary>${name}</summary>${\n                        arr2str(arr, a => `<pokemon-link-element url=\"${a.url}\" name=\"${a.name}\"></pokemon-link-element>` )\n                    }</details>`;\n\n\n            return `<h1>${ pokemon.name }</h1>\n                    <img src=\"${ `https://unpkg.com/pokeapi-sprites@2.0.2/sprites/pokemon/other/dream-world/${pokemon.id}.svg` }\" alt=\"\" />\n                    <div class=\"hiflex\">\n                        ${nameUrlArr('abilities',pokemon.abilities.map(a=>a.ability))}\n                        ${nameUrlArr('forms',pokemon.forms)}\n                        ${nameUrlArr('game indices',pokemon.game_indices.map(i=>i.version))}\n                        ${nameUrlArr('moves',pokemon.moves.map(i=>i.move))}\n                        ${nameUrlArr('stats',pokemon.stats.map(i=>i.stat))}\n                        ${nameUrlArr('types',pokemon.types.map(i=>i.type))}\n                        ${nameUrlArr('species',[pokemon.species])}\n                    </div>\n                    ${ renderCollection('Sprites'   ,sprites    ) }\n                    ${ renderCollection('other'     ,other      ) }\n                    ${ renderCollection('versions'  ,versions   ) }\n                    `;\n        }\n    });\n\nlet offset = 0\n,   limit = 10;\nconst getPokeList = async () =>\n    (  await\n        // fetch( '../test/pokeapi-page0.json')\n        fetch( `https://pokeapi.co/api/v2/pokemon?limit=${limit}&offset=${offset}`)\n    ).json()\n,   $ = $$()\n,   onSelected = async (p) => $$('pokemon-info-element').attr( 'src', p.url )\n,   getPokemonId = p=> ( arr=>(arr.pop(), arr.pop()) )( p.url.split('/') )\n,   getImgByPokemon = p =>`https://unpkg.com/pokeapi-sprites@2.0.2/sprites/pokemon/other/dream-world/${getPokemonId(p)}.svg`\n,   $template = $.slots('slot-select')\n,   $listContainer = $template.parent().$('dl')\n,   renderList = async()=>\n    {\n        const page = await getPokeList();\n\n        $listContainer.erase();\n        // yield version\n\n        if( offset ) // call chain with callbacks version\n            $listContainer.append(\n                $template.clone( page.results, (cloned, p,i)=>\n                $$(cloned)\n                    .prop('hidden', false )\n                    .prop('checked', !i, 'input')\n                    .prop('src', getImgByPokemon( p ), 'img')\n                    .on('click', ()=>onSelected(p) )\n                    .slots( 'index', ''+(offset + i) )\n                    .slots( 'name', p.name ) ) );\n        else // same without call chain, just as show case of HTMLElement API in CssChain\n            page.results.forEach( (p,i)=>\n            {\n                const $c = $template.clone();\n                $c.hidden = false;\n                $c.$('input').checked = !i;\n                $c.slots( 'index' ).innerText = ''+(offset + i);\n                $c.slots( 'name' ).innerText = p.name;\n                $c.on('click', ()=>onSelected(p) )\n                $c.$('img').src = getImgByPokemon( p );\n                $listContainer.append($c);\n            });\n\n        onSelected( page.results[0] );\n\n        prevBtn.disabled = offset <= 0;\n        nextBtn.disabled = offset+limit >= page.count;\n        return page;\n    };\n$template.remove();\nconst firstPage = await renderList()\n$.slots('counter').txt( firstPage.count );\nprevBtn.onclick = ()=> renderList( offset-=limit );\nnextBtn.onclick = ()=> renderList( offset+=limit );\n"],
  "mappings": "mRAAA,wEAEA,yCAEA,KAAM,GAAU,CAAC,EAAI,EAAI,EAAU,KAAO,EAAI,IAAI,CAAE,EAAE,KAAK,CAAS,EAChE,EAAQ,GAAO,GAAO,EAAI,UAAY,CAAC,MAAM,MAAM,KAAK,EAAE,KAAM,GAAG,EAAI,SAAS,CAAC,CAAE,EAEvF,OAAO,eAAe,OAAO,uBACzB,aAAiC,YACjC,CACI,mBACA,CACI,KAAM,GAAQ,EAAG,IAAI,EACjB,EAAI,GAAK,EAAM,EAAE,CAAC,EAChB,EAAO,EAAM,KAAK,MAAM,EACvB,EAAM,EAAM,KAAK,KAAK,EAC7B,GAAI,EAAM,CAAG,EACb,CACI,SACA,MAAO,GAAM,KAAM,eAAgB,WAAgB,KAAS,CAChE,CAGA,EAAM,KAAK,YAAY,MAAQ,gBAAmB,EAElD,EAAE,GAAG,EAAE,GAAG,QAAS,KAAM,IACzB,CACI,GADA,EAAE,eAAe,EACd,KAAK,OACJ,MAAO,GAAE,IAAI,EAAE,MAAM,EAAG,KAAK,OAAO,EACxC,KAAK,OAAQ,EACb,KAAM,GAAI,KAAQ,MAAM,OAAM,CAAG,GAAI,KAAK,EAC1C,EAAE,IAAI,EAAE,KAAM,EAAO,CAAC,CAAE,CAC5B,CAAC,EAED,WAAiB,EAAG,EAAE,GACtB,CACI,GAAI,AAAmB,GAAM,MAAQ,AAAa,MAAO,IAApB,UAAyB,AAAa,MAAO,IAApB,SAC1D,MAAI,GAAM,CAAC,EACA,eAAe;AAAA,EAAM,WAAW,MACpC,EAAI,eAAgB,mBAAqB,iBAAoB,QAAS,UAEjF,GAAI,MAAM,QAAS,CAAE,EACjB,MAAO,qBAAqB,aAAe,EAAS,EAAG,EAAO,OAAQ,eAE1E,GAAI,GAAM,CAAC,EAAG,EAAO,OAAO,KAAK,CAAC,EAClC,KAAM,GAAS,EAAE,MAAQ,EAAE,KAAS,EAAM,EAAE,GAAG,EACtC,eAAe,WAAc,OAC7B,+BAA+B,EAAE,cAAc,EAAE,gCAE1D,GAAI,EAAK,SAAU,GAAK,EAAE,MAAQ,EAAE,IAChC,EAAI,KAAM,CAAK,MAEnB,CAAI,AAAI,GACA,GAAI,KAAM,YAAa,EACvB,EAAI,KAAM,WAAY,YAAc,GAExC,OAAS,KAAK,GACV,OAAQ,OACC,OACD,GAAI,EAAE,IACF,UACH,MACD,EAAE,KAAO,EAAE,MAAQ,EAAI,KAAM,CAAK,EAAG,cAErC,AAAI,MAAM,QAAS,EAAG,EAAI,EACtB,EAAI,KAAM,qBAAsB,aAC5B,EAAS,EAAG,GAAK,GAAG,EAAO,CAAC,EAAE,OAAQ,cAC5B,EAEd,EAAI,KAAM,EAAQ,EAAG,GAAK,CAAE,CAAE,EAE9C,GAAK,EAAI,KAAM,aAAc,CACjC,CACA,MAAO,GAAI,KAAK,EAAE,CACtB,CACJ,CAEJ,CAAC,EAGL,OAAO,eAAe,OAAO,uBACzB,aAAiC,EACjC,CACI,OAAO,EACP,CACI,KAAwC,KAAQ,QAAxC,SAAO,YAAyB,EAAZ,IAAY,EAAZ,CAApB,QAAO,aACT,EAAmB,CAAC,EAAO,IAAS,qBAAqB;AAAA,kBACvD,EAAS,OAAO,QAAQ,CAAG,EAAG,CAAC,CAAC,EAAE,KAAO,AAAC,EAChC,AAAa,MAAO,IAApB,SACE,aAAa,aAAa,OAC1B,EAAiB,EAAE,CAAC,EAHc,EAGV,eAEtC,EAAkB,IAAO;AAAA,kBACvB,EAAS,EAAQ,UAAW,GAAK,YAAY,EAAE,QAAQ,QAAQ,EAAE,QAAQ,gBAAgB,EAAE,YAAa,eAE1G,EAAa,CAAC,EAAK,IAAM,qBAAqB,cACxC,EAAQ,EAAK,GAAK,8BAA8B,EAAE,cAAc,EAAE,+BAAgC,cAI9G,MAAO,OAAQ,EAAQ;AAAA,gCACF,6EAA6E,EAAQ;AAAA;AAAA,0BAE5F,EAAW,YAAY,EAAQ,UAAU,IAAI,GAAG,EAAE,OAAO,CAAC;AAAA,0BAC1D,EAAW,QAAQ,EAAQ,KAAK;AAAA,0BAChC,EAAW,eAAe,EAAQ,aAAa,IAAI,GAAG,EAAE,OAAO,CAAC;AAAA,0BAChE,EAAW,QAAQ,EAAQ,MAAM,IAAI,GAAG,EAAE,IAAI,CAAC;AAAA,0BAC/C,EAAW,QAAQ,EAAQ,MAAM,IAAI,GAAG,EAAE,IAAI,CAAC;AAAA,0BAC/C,EAAW,QAAQ,EAAQ,MAAM,IAAI,GAAG,EAAE,IAAI,CAAC;AAAA,0BAC/C,EAAW,UAAU,CAAC,EAAQ,OAAO,CAAC;AAAA;AAAA,sBAEzC,EAAiB,UAAa,CAAW;AAAA,sBACzC,EAAiB,QAAa,CAAW;AAAA,sBACzC,EAAiB,WAAa,CAAW;AAAA,qBAExD,CACJ,CAAC,EAEL,GAAI,GAAS,EACT,EAAQ,GACZ,KAAM,GAAc,SACb,MAEC,OAAO,2CAA2C,YAAgB,GAAQ,GAC5E,KAAK,EACP,EAAI,EAAG,EACP,EAAa,KAAO,IAAM,EAAG,sBAAsB,EAAE,KAAM,MAAO,EAAE,GAAI,EACxE,EAAe,GAAM,IAAM,GAAI,IAAI,EAAG,EAAI,IAAI,IAAM,EAAE,IAAI,MAAM,GAAG,CAAE,EACrE,EAAkB,GAAI,6EAA6E,EAAa,CAAC,QACjH,EAAY,EAAE,MAAM,aAAa,EACjC,EAAiB,EAAU,OAAO,EAAE,EAAE,IAAI,EAC1C,EAAa,SACb,CACI,KAAM,GAAO,KAAM,GAAY,EAE/B,SAAe,MAAM,EAGrB,AAAI,EACA,EAAe,OACX,EAAU,MAAO,EAAK,QAAS,CAAC,EAAQ,EAAE,IAC1C,EAAG,CAAM,EACJ,KAAK,SAAU,EAAM,EACrB,KAAK,UAAW,CAAC,EAAG,OAAO,EAC3B,KAAK,MAAO,EAAiB,CAAE,EAAG,KAAK,EACvC,GAAG,QAAS,IAAI,EAAW,CAAC,CAAE,EAC9B,MAAO,QAAS,GAAI,GAAS,EAAG,EAChC,MAAO,OAAQ,EAAE,IAAK,CAAE,CAAE,EAEnC,EAAK,QAAQ,QAAS,CAAC,EAAE,IACzB,CACI,KAAM,GAAK,EAAU,MAAM,EAC3B,EAAG,OAAS,GACZ,EAAG,EAAE,OAAO,EAAE,QAAU,CAAC,EACzB,EAAG,MAAO,OAAQ,EAAE,UAAY,GAAI,GAAS,GAC7C,EAAG,MAAO,MAAO,EAAE,UAAY,EAAE,KACjC,EAAG,GAAG,QAAS,IAAI,EAAW,CAAC,CAAE,EACjC,EAAG,EAAE,KAAK,EAAE,IAAM,EAAiB,CAAE,EACrC,EAAe,OAAO,CAAE,CAC5B,CAAC,EAEL,EAAY,EAAK,QAAQ,EAAG,EAE5B,QAAQ,SAAW,GAAU,EAC7B,QAAQ,SAAW,EAAO,GAAS,EAAK,MACjC,CACX,EACJ,EAAU,OAAO,EACjB,KAAM,GAAY,KAAM,GAAW,EACnC,EAAE,MAAM,SAAS,EAAE,IAAK,EAAU,KAAM,EACxC,QAAQ,QAAU,IAAK,EAAY,GAAQ,CAAM,EACjD,QAAQ,QAAU,IAAK,EAAY,GAAQ,CAAM",
  "names": []
}
